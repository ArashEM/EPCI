#!groovy
//********************************************************************************************                                                        
//	  ______                                __                ________  __       __ 
//	 /      \                              |  \              |        \|  \     /  \
//	|  $$$$$$\  ______   ______    _______ | $$____          | $$$$$$$$| $$\   /  $$
//	| $$__| $$ /      \ |      \  /       \| $$    \  ______ | $$__    | $$$\ /  $$$
//	| $$    $$|  $$$$$$\ \$$$$$$\|  $$$$$$$| $$$$$$$\|      \| $$  \   | $$$$\  $$$$
//	| $$$$$$$$| $$   \$$/      $$ \$$    \ | $$  | $$ \$$$$$$| $$$$$   | $$\$$ $$ $$
//	| $$  | $$| $$     |  $$$$$$$ _\$$$$$$\| $$  | $$        | $$_____ | $$ \$$$| $$
//	| $$  | $$| $$      \$$    $$|       $$| $$  | $$        | $$     \| $$  \$ | $$
//	 \$$   \$$ \$$       \$$$$$$$ \$$$$$$$  \$$   \$$         \$$$$$$$$ \$$      \$$
//	                                                                                
//	                                                                                
//	                        
//********************************************************************************************
pipeline{
    agent none 
    stages {
        stage('Build'){
         agent {
            label 'dh-01'
        }
            steps {
                git 'https://github.com/ArashEM/EPCI.git'
                dir('FW/sources/driver'){
                    sh 'make clean'
                    sh 'make'
                }
                archiveArtifacts 'FW/sources/driver/build/*.ko'
            }   
        }
    }
    post {
		cleanup {
		        node('dh-01'){
		            deleteDir()
		        }
		}
	}
}